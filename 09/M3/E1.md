<h1 align="center">Øvelser 9:<br>Matrixalgebra og determinanter</h1>

I skal lave øvelserne inden timerne torsdag. I kan med fordel lave dem i grupper og diskutere dem indbyrdes. Det er vigtigt, at I forstår opgaverne og kan forklare dem til hinanden. På torsdag diskuterer vi opgaverne, og I skal være klar til at præsentere dem for klassen.

<style>
body[data-md-color-scheme] .md-content ol       { list-style-type: lower-alpha; }
body[data-md-color-scheme] .md-content ol li    { padding-left: 10px; }
</style>

**[Python]** Betyder at du anbefales at bruge Python til at løse øvelsen. Du kan finde Python-løsningerne [her](https://github.com/RBrooksDK/MSE1_25/blob/main/09/Python_solutions_for_exercises_09.ipynb) eller download dem [her](../Python_solutions_for_exercises_09.ipynb)

#### Øvelse 1
1. Bestem *ved inspektion* om følgende sæt af vektorer er lineært uafhængige eller afhængige. Begrund hvert svar.
{ .annotate }

    i. $\left[\begin{array}{l}5 \\ 1\end{array}\right],\left[\begin{array}{l}2 \\ 8\end{array}\right],\left[\begin{array}{l}1 \\ 3\end{array}\right],\left[\begin{array}{r}-1 \\ 7\end{array}\right]$ (1)
    { .annotate }

    1. Afhængige

    ii. $\left[\begin{array}{r}2 \\ -4 \\ 8\end{array}\right],\left[\begin{array}{r}-3 \\ 6 \\ -12\end{array}\right]$  (1)
    { .annotate }

    1. Afhængige

    iii. $\left[\begin{array}{r}5 \\ -3 \\ -1\end{array}\right],\left[\begin{array}{l}0 \\ 0 \\ 0\end{array}\right],\left[\begin{array}{r}-7 \\ 2 \\ 4\end{array}\right]$  (1)
    { .annotate }

    1. Afhængige

    iv. $\left[\begin{array}{l}3 \\ 4\end{array}\right],\left[\begin{array}{r}-1 \\ 5\end{array}\right],\left[\begin{array}{l}3 \\ 5\end{array}\right],\left[\begin{array}{l}7 \\ 1\end{array}\right]$  (1)
    { .annotate }

    1. Afhængige

    v. $\left[\begin{array}{r}-8 \\ 12 \\ -4\end{array}\right],\left[\begin{array}{r}2 \\ -3 \\ -1\end{array}\right]$  (1)
    { .annotate }

    1. Uafhængige

    vi. $\left[\begin{array}{r}1 \\ 4 \\ -7\end{array}\right],\left[\begin{array}{r}-2 \\ 5 \\ 3\end{array}\right],\left[\begin{array}{l}0 \\ 0 \\ 0\end{array}\right]$  (1)
    { .annotate }

    1. Afhængige

2. Lad $A = \left[\begin{array}{cccccc}1 & -4 & -2 & 0 & 3 & -5 \\ 0 & 0 & 1 & 0 & 0 & -1 \\ 0 & 0 & 0 & 0 & 1 & -4 \\ 0 & 0 & 0 & 0 & 0 & 0\end{array}\right]$

    Beskriv alle løsninger til $A \mathbf{x}=\mathbf{0}$ i parametrisk form.

    ??? answer "&nbsp;"

        For at beskrive alle løsninger til $A\mathbf{x}=\mathbf{0}$ i parametrisk form, skriver vi først (koefficient)matricen og reducerer den til reduceret echelonform:

        $$
        \left[\begin{array}{cccccc}
        1 & -4 & -2 & 0 & 3 & -5  \\
        0 & 0 & 1 & 0 & 0 & -1  \\
        0 & 0 & 0 & 0 & 1 & -4  \\
        0 & 0 & 0 & 0 & 0 & 0 
        \end{array}\right]
        \sim
        \left[\begin{array}{cccccc}
        1 & -4 & 0 & 0 & 0 & 5  \\
        0 & 0 & 1 & 0 & 0 & -1  \\
        0 & 0 & 0 & 0 & 1 & -4  \\
        0 & 0 & 0 & 0 & 0 & 0 
        \end{array}\right]
        $$

        Derfor er løsningen i parametrisk form:

        $$
        \mathbf{x} = \left[\begin{array}{c}
        x_1 \\
        x_2 \\
        x_3 \\
        x_4 \\
        x_5 \\
        x_6
        \end{array}\right] = x_2 \left[\begin{array}{c}
        4 \\
        1 \\
        0 \\
        0 \\
        0 \\
        0
        \end{array}\right] + x_4 \left[\begin{array}{c}
        0 \\
        0 \\
        0 \\
        1 \\
        0 \\
        0
        \end{array}\right] + x_6 \left[\begin{array}{c}
        -5 \\
        0 \\
        1 \\
        0 \\
        4 \\
        1
        \end{array}\right]
        $$

        hvor $x_2$, $x_4$, og $x_6$ er frie variable.

3. **[Python]** Brug så mange kolonner af $A$ som muligt til at konstruere en matrix $B$ med den egenskab, at ligningen $B \mathbf{x}=\mathbf{0}$ kun har den trivielle løsning. Løs $B \mathbf{x}=\mathbf{0}$ for at verificere dit arbejde.

$A=\left[\begin{array}{rrrrr}3 & -4 & 10 & 7 & -4 \\ -5 & -3 & -7 & -11 & 15 \\ 4 & 3 & 5 & 2 & 1 \\ 8 & -7 & 23 & 4 & 15\end{array}\right]$

??? answer "&nbsp;"

    Når den reduceres til echelonform, vil du have pivoter i kolonner 1, 2 og 4. Derfor kan du bruge kolonner 1, 2 og 4 til at konstruere matrix B.

    Du kan verificere dit arbejde ved at løse ligningen $B \mathbf{x}=\mathbf{0}$, hvilket gøres ved at finde den reducerede echelonform af B. Dette vil give dig den trivielle løsning.

#### Øvelse 2

I (a) og (b) beregn hver matrixsum eller produkt hvis det er defineret. Hvis et udtryk er udefineret, forklar hvorfor. Lad

$$
\begin{aligned}
& A=\left[\begin{array}{rrr}
2 & 0 & -1 \\
4 & -5 & 2
\end{array}\right], \quad B=\left[\begin{array}{rrr}
7 & -5 & 1 \\
1 & -4 & -3
\end{array}\right], \\
& C=\left[\begin{array}{rr}
1 & 2 \\
-2 & 1
\end{array}\right], \quad D=\left[\begin{array}{rr}
3 & 5 \\
-1 & 4
\end{array}\right], \quad E=\left[\begin{array}{r}
-5 \\
3
\end{array}\right]
\end{aligned}
$$

1. $-2 A, \; B-2 A, \; A C, \; C D$

    ??? answer "&nbsp;"

        $-2 A=(-2)\left[\begin{array}{rrr}2 & 0 & -1 \\ 4 & -5 & 2\end{array}\right]=\left[\begin{array}{rrr}-4 & 0 & 2 \\ -8 & 10 & -4\end{array}\right]$. Dernæst, brug $B-2 A=B+(-2 A)$ :

        $$
            B-2 A=\left[\begin{array}{rrr}
        7 & -5 & 1 \\
        1 & -4 & -3
        \end{array}\right]+\left[\begin{array}{rrr}
        - 4 & 0 & 2 \\
        -8 & 10 & -4
        \end{array}\right]=\left[\begin{array}{rrr}
        3 & -5 & 3 \\
        -7 & 6 & -7
        \end{array}\right]
        $$


        Produktet $A C$ er ikke defineret, fordi antallet af kolonner i $A$ ikke matcher antallet af rækker i $C . C D=\left[\begin{array}{rr}1 & 2 \\ -2 & 1\end{array}\right]\left[\begin{array}{rr}3 & 5 \\ -1 & 4\end{array}\right]=\left[\begin{array}{rr}1 \cdot 3+2(-1) & 1 \cdot 5+2 \cdot 4 \\ -2 \cdot 3+1(-1) & -2 \cdot 5+1 \cdot 4\end{array}\right]=\left[\begin{array}{rr}1 & 13 \\ -7 & -6\end{array}\right]$. For mental beregning er række-kolonne-reglen sandsynligvis lettere at bruge end definitionen.


2. **[Python]** $A+3 B, \; 2 C-3 E, \; D B, \; E C$

    ??? answer "&nbsp;"

        $$
        A+3 B=\left[\begin{array}{rrr}
        2 & 0 & -1 \\
        4 & -5 & 2
        \end{array}\right]+3\left[\begin{array}{rrr}
        7 & -5 & 1 \\
        1 & -4 & -3
        \end{array}\right]=\left[\begin{array}{rrr}
        2+21 & 0-15 & -1+3 \\
        4+3 & -5-12 & 2-9
        \end{array}\right]=\left[\begin{array}{rrr}
        23 & -15 & 2 \\
        7 & -17 & -7
        \end{array}\right]
        $$

        Udtrykket $2 C-3 E$ er ikke defineret, fordi $2 C$ har 2 kolonner og $-3 E$ har kun 1 kolonne.

        $$
        D B=\left[\begin{array}{rr}
        3 & 5 \\
        -1 & 4
        \end{array}\right]\left[\begin{array}{rrr}
        7 & -5 & 1 \\
        1 & -4 & -3
        \end{array}\right]=\left[\begin{array}{rrr}
        3 \cdot 7+5 \cdot 1 & 3(-5)+5(-4) & 3 \cdot 1+5(-3) \\
        -1 \cdot 7+4 \cdot 1 & -1(-5)+4(-4) & -1 \cdot 1+4(-3)
        \end{array}\right]=\left[\begin{array}{rrr}
        26 & -35 & -12 \\
        -3 & -11 & -13
        \end{array}\right]
        $$

        Produktet $E C$ er ikke defineret, fordi antallet af kolonner i $E$ ikke matcher antallet af rækker i $C$.

3. **[Python]** Lad $A=\left[\begin{array}{rr}3 & -6 \\ -1 & 2\end{array}\right], B=\left[\begin{array}{rr}-1 & 1 \\ 3 & 4\end{array}\right]$, og $C= \left[\begin{array}{rr}-3 & -5 \\ 2 & 1\end{array}\right]$. Verificer at $A B=A C$ og alligevel $B \neq C$.

    ??? answer "&nbsp;"

        For at verificere at \( AB = AC \) men \( B \neq C \), beregner vi \( AB \) og \( AC \) og sammenligner dem.

        Givet:

        $$
        A = \left[\begin{array}{rr} 3 & -6 \\ -1 & 2 \end{array}\right], \quad B = \left[\begin{array}{rr} -1 & 1 \\ 3 & 4 \end{array}\right], \quad C = \left[\begin{array}{rr} -3 & -5 \\ 2 & 1 \end{array}\right]
        $$

        **Beregn \( AB \):**
    
        $$
        AB = \left[\begin{array}{rr} 3 & -6 \\ -1 & 2 \end{array}\right] \left[\begin{array}{rr} -1 & 1 \\ 3 & 4 \end{array}\right] = \left[\begin{array}{rr} -21 & -21 \\ 7 & 7 \end{array}\right]
        $$

        **Beregn \( AC \):**

        \[
        AC = \left[\begin{array}{rr} 3 & -6 \\ -1 & 2 \end{array}\right] \left[\begin{array}{rr} -3 & -5 \\ 2 & 1 \end{array}\right] = \left[\begin{array}{rr} -21 & -21 \\ 7 & 7 \end{array}\right]
        \]

        Siden \( AB = \left[\begin{array}{rr} -21 & -21 \\ 7 & 7 \end{array}\right] = AC \), konkluderer vi \( AB = AC \).

        Derfor \( AB = AC \) men \( B \neq C \).

4. **[Python]** Hvis $A=\left[\begin{array}{rr}1 & -3 \\ -3 & 5\end{array}\right]$ og $A B=\left[\begin{array}{rr}-3 & -11 \\ 1 & 17\end{array}\right]$, bestem matrixen $B$.

    ??? answer "&nbsp;"

        Siden $\left[\begin{array}{rr}-3 & -11 \\ 1 & 17\end{array}\right]=A B=\left[\begin{array}{ll}A \mathbf{b}_1 & A \mathbf{b}_2\end{array}\right]$, opfylder første kolonne af $B$ ligningen $A \mathbf{x}=\left[\begin{array}{r}-1 \\ 6\end{array}\right]$. Række reduktion: $\left[\begin{array}{ll}A & A \mathbf{b}_1\end{array}\right] \sim\left[\begin{array}{rrr}1 & -3 & -3 \\ -3 & 5 & 1\end{array}\right] \sim\left[\begin{array}{lll}1 & 0 & 3 \\ 0 & 1 & 2\end{array}\right]$. Så $\mathbf{b}_1=\left[\begin{array}{l}3 \\ 2\end{array}\right]$. Tilsvarende, $\left[\begin{array}{ll}A & A \mathbf{b}_2\end{array}\right] \sim\left[\begin{array}{rrr}1 & -3 & -11 \\ -3 & 5 & 17\end{array}\right] \sim\left[\begin{array}{lll}1 & 0 & 1 \\ 0 & 1 & 4\end{array}\right]$ og $\mathbf{b}_2=\left[\begin{array}{l}1 \\ 4\end{array}\right]$.

        Bemærk: En alternativ løsning er at række reducere $\left[\begin{array}{lll}A & A \mathbf{b}_1 & A \mathbf{b}_2\end{array}\right]$ med en sekvens af række operationer. Denne observation kan forberede vejen for inversionsalgoritmen nævnt i bogen.

#### Øvelse 3

1. Find inverserne af $\begin{array}{cc}{\left[\begin{array}{l}8 \\ 5\end{array}\right.} & \left.\begin{array}{c}6 \\ 4\end{array}\right]\end{array}$ og $\begin{array}{cc}{\left[\begin{array}{l}3 \\ 8\end{array}\right.} & \left.\begin{array}{c}2 \\ 5\end{array}\right]\end{array}$.

    ??? answer "&nbsp;"

        $\left[\begin{array}{ll}8 & 6 \\ 5 & 4\end{array}\right]^{-1}=\frac{1}{32-30}\left[\begin{array}{rr}4 & -6 \\ -5 & 8\end{array}\right]=\left[\begin{array}{cr}2 & -3 \\ -5 / 2 & 4\end{array}\right]$
        
        $\left[\begin{array}{ll}3 & 2 \\ 8 & 5\end{array}\right]^{-1}=\frac{1}{15-16}\left[\begin{array}{rr}5 & -2 \\ -8 & 3\end{array}\right]=\left[\begin{array}{cc}-5 & 2 \\ 8 & -3\end{array}\right]$

2. **[Python]** Brug inversen fundet i Øvelse 3.a til at løse systemet

    $\begin{aligned}
    & 8 x_1+6 x_2=2 \\
    & 5 x_1+4 x_2=-1
    \end{aligned}$

    ??? answer "&nbsp;"
        Systemet er ækvivalent med $A \mathbf{x}=\mathbf{b}$, hvor $A=\left[\begin{array}{ll}8 & 6 \\ 5 & 4\end{array}\right]$ og $\mathbf{b}=\left[\begin{array}{r}2 \\ -1\end{array}\right]$, og løsningen er $\mathbf{x}=A^{-1} \mathbf{b}=\left[\begin{array}{cr}2 & -3 \\ -5 / 2 & 4\end{array}\right]\left[\begin{array}{r}2 \\ -1\end{array}\right]=\left[\begin{array}{r}7 \\ -9\end{array}\right]$. Så $x_1=7$ og $x_2=-9$.

3. **[Python]** Find inversen af matricen. Brug algoritmen til at finde inversen af en $n \times n$ matrix.

    $\left[\begin{array}{rrr}
    1 & 0 & -2 \\
    -3 & 1 & 4 \\
    2 & -3 & 4
    \end{array}\right]$

    ??? answer "&nbsp;"

        $$
        \begin{aligned}
        & {\left[\begin{array}{ll}
        A & I
        \end{array}\right]=\left[\begin{array}{rrrrrr}
        1 & 0 & -2 & 1 & 0 & 0 \\
        -3 & 1 & 4 & 0 & 1 & 0 \\
        2 & -3 & 4 & 0 & 0 & 1
        \end{array}\right] \sim\left[\begin{array}{rrrrrr}
        1 & 0 & -2 & 1 & 0 & 0 \\
        0 & 1 & -2 & 3 & 1 & 0 \\
        0 & -3 & 8 & -2 & 0 & 1
        \end{array}\right]} \\
        & \sim\left[\begin{array}{rrrrrr}
        1 & 0 & -2 & 1 & 0 & 0 \\
        0 & 1 & -2 & 3 & 1 & 0 \\
        0 & 0 & 2 & 7 & 3 & 1
        \end{array}\right] \sim\left[\begin{array}{rrrrrr}
        1 & 0 & 0 & 8 & 3 & 1 \\
        0 & 1 & 0 & 10 & 4 & 1 \\
        0 & 0 & 2 & 7 & 3 & 1
        \end{array}\right] \\
        & \sim\left[\begin{array}{cccccc}
        1 & 0 & 0 & 8 & 3 & 1 \\
        0 & 1 & 0 & 10 & 4 & 1 \\
        0 & 0 & 1 & 7 / 2 & 3 / 2 & 1 / 2
        \end{array}\right] . \quad A^{-1}=\left[\begin{array}{ccc}
        8 & 3 & 1 \\
        10 & 4 & 1 \\
        7 / 2 & 3 / 2 & 1 / 2
        \end{array}\right]
        \end{aligned}
        $$

#### Øvelse 4

I denne øvelse er matricerne alle $n \times n$. Hver del af øvelsen er en implikation af formen "Hvis (udsagn 1), så (udsagn 2)." Markér en implikation som Sand hvis sandheden af (udsagn 2) altid følger når (udsagn 1) sker at være sand. En implikation er Falsk hvis der er en instans hvor (udsagn 2) er falsk men (udsagn 1) er sand. Begrund hvert svar.

1. Hvis ligningen $A \mathbf{x}=\mathbf{0}$ kun har den trivielle løsning, så er $A$ række ækvivalent med den $n \times n$ identitetsmatrix. (1)
{ .annotate }

    1. Sand

2. Hvis kolonnerne af $A$ spænder $\mathbb{R}^n$, så er kolonnerne lineært uafhængige.  (1)
{ .annotate }

    1. Sand

3. Hvis $A$ er en $n \times n$ matrix, så har ligningen $A \mathbf{x}=\mathbf{b}$ mindst én løsning for hver $\mathbf{b}$ i $\mathbb{R}^n$. (1)
{ .annotate }

    1. Falsk

4. Hvis ligningen $A \mathbf{x}=\mathbf{0}$ har en ikke-triviel løsning, så har $A$ færre end $n$ pivotpositioner. (1)
{ .annotate }

    1. Sand

5. Hvis $A^T$ ikke er inverterbar, så er $A$ ikke inverterbar.  (1)
{ .annotate }

    1. Sand

#### Øvelse 5
**[Python]** Givet

$A=\left[\begin{array}{ccc}1 & 0 & 0 \\ 0 & 3 & 0 \\ 0 & 0 & -3\end{array}\right]$ og $B=\left[\begin{array}{ccc}1 & 1 & 1 \\ 1 & 1 & 1 \\ 1 & 1 & 1\end{array}\right]$.

Løs matrixligningen $X+A=2(X-B)$.

??? answer "&nbsp;"

    Matrixligningen $X+A=2(X-B)$ kan omskrives som $X+A=2 X-2 B$. Ved at omarrangere termer får vi $X-2 X=-A-2 B$. Ved at forenkle har vi $-X=-A-2 B$. Ved at multiplicere med $-1$ får vi $X=A+2 B$.

    Ved at substituere de givne matricer $A$ og $2B$ i ligningen har vi:

    \[
    X=A+2 B=\left[\begin{array}{ccc}
    1 & 0 & 0 \\
    0 & 3 & 0 \\
    0 & 0 & -3
    \end{array}\right]+\left[\begin{array}{lll}
    2 & 2 & 2 \\
    2 & 2 & 2 \\
    2 & 2 & 2
    \end{array}\right]=\left[\begin{array}{ccc}
    3 & 2 & 2 \\
    2 & 5 & 2 \\
    2 & 2 & -1
    \end{array}\right]
    \]

    Derfor er løsningen til matrixligningen $X+A=2(X-B)$ $X=\left[\begin{array}{ccc}3 & 2 & 2 \\ 2 & 5 & 2 \\ 2 & 2 & -1\end{array}\right]$.

#### Øvelse 6

**[Python]** Lad matricen $A$ være givet ved

$A=\left[\begin{array}{cc}
3-2 q & 1 \\
4 & 3+2 q
\end{array}\right]$

hvor $q$ er en skalar. Beregn $q$ så at

$A^2=\left[\begin{array}{cc}
29 & 6 \\
24 & 125
\end{array}\right]$

??? answer "&nbsp;"

    Lad
    $A = \begin{bmatrix} 3 - 2q & 1 \\ 4 & 3 + 2q \end{bmatrix}.$

    Så,
    $A^2 = \begin{bmatrix} (3 - 2q)^2 + 4 & 6 \\ 24 & (3 + 2q)^2 + 4 \end{bmatrix}.$
    Siden \( A^2 = \begin{bmatrix} 29 & 6 \\ 24 & 125 \end{bmatrix} \), har vi:

    \((3 - 2q)^2 + 4 = 29 \Rightarrow \)  $(3 - 2q)^2 = 25 \Rightarrow 3 - 2q = \pm 5$
    
    **Tilfælde 1:** \(3 - 2q = 5 \Rightarrow q = -1\).

    **Tilfælde 2:** \(3 - 2q = -5 \Rightarrow q = 4\).

    Kontrollér:
    For \(q = -1\), har vi:
    $A^2=\left[\begin{array}{ll}5 & 1 \\ 4 & 1\end{array}\right]\left[\begin{array}{ll}5 & 1 \\ 4 & 1\end{array}\right]=\left[\begin{array}{ll}29 & 6 \\ 24 & 9\end{array}\right]$

    For \(q = 4\), har vi:
    $A^2=\left[\begin{array}{cc}-5 & 1 \\ 4 & 11\end{array}\right]\left[\begin{array}{cc}-5 & 1 \\ 4 & 11\end{array}\right]=\left[\begin{array}{cc}29 & 6 \\ 24 & 125\end{array}\right]$

    Så kun \(q = 4\) opfylder ligningen.
